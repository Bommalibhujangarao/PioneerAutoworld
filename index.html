<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Pioneer Autoworld</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
<link rel="icon" href="https://i.ibb.co/6c61xgtw/Pioneer.png" />
<link rel="apple-touch-icon" href="https://i.ibb.co/6c61xgtw/Pioneer.png" />
<style>
body {font-family: 'Roboto', sans-serif;background: #f9f9f9;margin: 0;padding: 0;}
.navbar {background: #fff;padding: 0.5rem 1rem;box-shadow: 0 1px 2px rgba(0,0,0,0.1);}
.main-section {padding: 15px;max-width: 600px;margin: auto;}
.chat-container {background: #fff;border: 1px solid blue;border-radius: 8px;padding: 15px;margin-bottom: 10px;box-shadow: 0 2px 5px rgba(0,0,0,0.1);}
.chat-container h2 {color: blue;font-size: 24px;}
.button {background: #25D366;color: white;border: none;width: 100%;padding: 10px;margin: 5px 0;border-radius: 5px;cursor: pointer;}
.button:hover {background: #040e38;color: yellow;}
.info,.V1,.V2 {width: 100%;padding: 5px;margin: 5px 0;border: 1px solid #ccc;border-radius: 5px;text-align: center;}
#Qtn2 {display: none;}
.location-list div, .model-list div {padding: 8px;cursor: pointer;border:1px solid #ddd;background:#fff;border-radius:5px;margin-top:2px;}
.location-list div:hover, .model-list div:hover {background: #f0f0f0;}
h2 {margin-bottom: 2px; font-size: 18px; color: blue;font-weight:800;}
</style>
</head>
<body>
<nav class="navbar navbar-light px-4 sticky-top">
  <a class="navbar-brand" href="#"><img src="https://i.ibb.co/6c61xgtw/Pioneer.png" alt="Pioneer Logo" style="height:50px;" /></a>
  <a class="navbar-brand" href="#"><img src="https://i.ibb.co/KjQ1zpwm/Mahindra-Logo.png" alt="Mahindra Logo" style="height:50px;" /></a>
</nav>
<div class="main-section">
<form id="frm" action="https://script.google.com/macros/s/AKfycbxWGc1UTma7lrcJp2dRqUiTnm_51Ck0582WaKfYYg7J4JxQsqLcH1xSBQQ40hSd97cE/exec" method="POST">
  <div class="chat-container text-center">
    <h2><span style="color:black;">Pioneer </span><span style="color:red;font-weight:800;">Autoworld</span> Feedback Form</h2>
    <p>Please share complete details for quick response on your feedback</p>
    <input type="text" id="RegNo" name="RegNo" class="info" placeholder="Vehicle Number" required />
    <input type="text" id="Mobile" name="Mobile" class="info" placeholder="Contact Number" oninput="validateMobile(event)" required />
    
    <!-- Model selection -->
    <input type="text" id="Model" name="Model" class="info" placeholder="Select Vehicle Model" oninput="filterModels()" autocomplete="off" required />
    <div id="ModelList" class="model-list"></div>

    <!-- Workshop selection -->
    <input type="text" id="Loc" name="Loc" class="info" placeholder="Workshop Visited" oninput="filterLocations()" autocomplete="off" required />
    <div id="Locr" class="location-list"></div>
  </div>
  
  <div class="chat-container">
    <h2>How was your experience with Pioneer Autoworld?</h2>
    <button class="button V1" type="button" data-value="Excellent">Excellent</button>
    <button class="button V1" type="button" data-value="Good">Good</button>
    <button class="button V1" type="button" data-value="Fair">Fair</button>
    <button class="button V1" type="button" data-value="Poor">Poor</button>
    <button class="button V1" type="button" data-value="Unacceptable">Unacceptable</button>
  </div>
  
  <div class="chat-container" id="Qtn2">
    <h2>Tell us what went wrong: (Select all that apply)</h2>
    <button class="button V2" type="button" data-value="Transparency & Fairness of Charges">Transparency & Fairness of Charges</button>
    <button class="button V2" type="button" data-value="Updates on Vehicle Status">Updates on Vehicle Status</button>
    <button class="button V2" type="button" data-value="Time taken for service">Time taken for service</button>
    <button class="button V2" type="button" data-value="Experience with Service Advisor">Experience with Service Advisor</button>
    <button class="button V2" type="button" data-value="Quality of work done">Quality of work done</button>
    <button class="button V2" type="button" data-value="Cleanliness of Vehicle">Cleanliness of Vehicle</button>
    <button class="button V2" type="button" data-value="Others">Others</button>
  </div>
  
  <div class="chat-container">
    <h2>How likely are you to recommend us to others? (0 to 10)</h2>
    <input type="number" id="nps" name="NPS" class="info" placeholder="Enter between (0‚Äì10)" oninput="validateNPS(event)" required />
  </div>
  
  <div class="chat-container">
    <h2>Any additional comments?</h2>
    <textarea id="commentBox" name="Comments" class="info" rows="3" placeholder="Your comments here..."></textarea>
  </div>
  
  <div class="chat-container">
    <button class="button" type="submit">Submit Feedback</button>
  </div>
</form>
</div>

<script>
// Prevent inspection (basic deterrent)
document.addEventListener('contextmenu', event => event.preventDefault());
document.onkeydown = function(e) {
  if (e.keyCode == 123 || (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0))) return false;
};

// Maintenance control
const expiryDate = new Date("2025-11-30");
const currentDate = new Date();
if (currentDate > expiryDate) {
  document.body.innerHTML = `
    <div style="display:flex;justify-content:center;align-items:center;height:100vh;background:#f8f9fa;flex-direction:column;text-align:center;color:#333;">
      <img src='https://i.ibb.co/6c61xgtw/Pioneer.png' alt='Pioneer Logo' style='width:120px;margin-bottom:20px;'/>
      <h1 style="color:red;font-weight:800;">This Webpage is under Maintenance</h1>
      <p style="font-size:18px;">Please check back later. We‚Äôll be back soon!</p>
    </div>`;
  document.title = "Under Maintenance - Pioneer Autoworld";
}

// Data arrays
const locations = [["Rajahmundry", "46NA-03", "919701970142"],["Bhimavaram", "4603-10", "919701970142"],["Mandapeta", "SJH1-01", "919701970142"],["Amalapuram", "SJG1-01", "919701970142"],["Tadepalligudem", "4603-0K", "919701970142"]];

const models = [
  "XUV700","Scorpio-N","Thar","Thar Roxx","Bolero","Bolero Neo","Bolero Neo Plus",
  "XUV 3XO","XUV400","BE 6","XEV 9e","XEV 9S","XUV 3XO RevX","XUV300 (earlier)",
  "Marazzo","Bolero Pik-Up","Bolero Camper","Bolero Maxx Pik-Up City","Maxx City / Maxx HD",
  "Jeeto","Supro (van)","Furio","Blazo X","LoadKing","Treon / e-Alfa / Alfa (3W)",
  "Treo (electric 3W)","Veero"
];

// State variables
let experienceRating = "", issuesList = [], selectedPhone = "";

// Experience rating
document.querySelectorAll(".V1").forEach(btn => {
  btn.addEventListener("click", () => {
    experienceRating = btn.dataset.value;
    document.querySelectorAll(".V1").forEach(b => b.style.background = "#25D366");
    btn.style.background = "#040e38";
    document.getElementById("Qtn2").style.display = ["Good","Fair","Poor","Unacceptable"].includes(experienceRating) ? "block" : "none";
  });
});

// Issues selection
document.querySelectorAll(".V2").forEach(btn => {
  btn.addEventListener("click", () => {
    const val = btn.dataset.value;
    if (issuesList.includes(val)) {
      issuesList = issuesList.filter(v => v !== val);
      btn.style.background = "#25D366";
    } else {
      issuesList.push(val);
      btn.style.background = "#040e38";
    }
  });
});

// Input validations
function validateMobile(e) {
  e.target.value = e.target.value.replace(/\D/g, '').slice(0, 10);
}
function validateNPS(e) {
  let val = e.target.value.replace(/\D/g, '');
  if (val > 10) val = "10";
  e.target.value = val;
}

// Filter workshops
function filterLocations() {
  const query = document.getElementById("Loc").value.toLowerCase();
  const results = document.getElementById("Locr");
  results.innerHTML = "";
  const filtered = locations.filter(loc => loc[0].toLowerCase().includes(query));
  filtered.forEach(loc => {
    const div = document.createElement("div");
    div.textContent = loc[0];
    div.onclick = () => {
      document.getElementById("Loc").value = loc[0];
      selectedPhone = loc[2];
      results.innerHTML = "";
    };
    results.appendChild(div);
  });
  if (!filtered.length) results.innerHTML = "<div>No match found</div>";
}

// Filter models
function filterModels() {
  const query = document.getElementById("Model").value.toLowerCase();
  const results = document.getElementById("ModelList");
  results.innerHTML = "";
  const filtered = models.filter(m => m.toLowerCase().includes(query));
  filtered.forEach(m => {
    const div = document.createElement("div");
    div.textContent = m;
    div.onclick = () => {
      document.getElementById("Model").value = m;
      results.innerHTML = "";
    };
    results.appendChild(div);
  });
  if (!filtered.length) results.innerHTML = "<div>No model found</div>";
}

// Form submission
document.getElementById("frm").addEventListener("submit", function (e) {
  e.preventDefault();
  
  const regNo = document.getElementById("RegNo").value.trim().toUpperCase();
  const mobile = document.getElementById("Mobile").value.trim();
  const model = document.getElementById("Model").value.trim();
  const location = document.getElementById("Loc").value.trim();
  const nps = document.getElementById("nps").value.trim();
  const comment = document.getElementById("commentBox").value.trim();

  if (!regNo || !mobile || !model || !location || !experienceRating || nps === "") {
    alert("‚ö†Ô∏è Please fill in all required fields and select a rating.");
    return;
  }
  if (!selectedPhone) {
    alert("‚ö†Ô∏è Please select a valid Workshop from the suggestions.");
    return;
  }
  if (nps < 0 || nps > 10) {
    alert("‚ö†Ô∏è Please enter NPS between 0 and 10.");
    return;
  }

  const form = e.target;
  const formData = new FormData(form);
  formData.set("RegNo", regNo);
  formData.append("Experience", experienceRating);
  formData.append("Issues", issuesList.join(", "));
  formData.set("Comments", comment);

  fetch(form.action, { method: "POST", body: formData })
    .then(res => res.text())
    .then(res => {
      const issuesText = issuesList.length ? `\n*Issues:*\n- ${issuesList.join("\n- ")}` : "";
      const feedbackMsg =
        `*Hi!* üëã\n\n` +
        `Here‚Äôs my feedback for *PIONEER AUTOWORLD* üöó\n\n` +
        `*Vehicle No:* ${regNo}\n` +
        `*Model:* ${model}\n` +
        `*Mobile:* ${mobile}\n` +
        `*Workshop:* ${location}\n` +
        `*Experience:* ${experienceRating}${issuesText}\n\n` +
        `*Referred to Others (0‚Äì10):* ${nps}\n\n` +
        `üí¨ *Additional Feedback:* ${comment || "No Feedback"}\n\n`;

      const encoded = encodeURIComponent(feedbackMsg);
      const whatsappURL = `https://wa.me/${selectedPhone}?text=${encoded}`;
      window.open(whatsappURL, "_blank");

      form.reset();
      document.getElementById("Locr").innerHTML = "";
      document.getElementById("ModelList").innerHTML = "";
      document.getElementById("Qtn2").style.display = "none";
      document.querySelectorAll(".V1, .V2").forEach(b => b.style.background = "#25D366");
      experienceRating = "";
      issuesList = [];
    })
    .catch(err => {
      console.error("‚ùå Error:", err);
      alert("Error submitting feedback. Please try again.");
    });
});
</script>
</body>
</html>
